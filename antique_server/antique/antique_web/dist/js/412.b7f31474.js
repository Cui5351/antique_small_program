"use strict";(self["webpackChunkoil"]=self["webpackChunkoil"]||[]).push([[412],{2568:function(e,t,l){l.d(t,{Aq:function(){return M},Hq:function(){return V},IC:function(){return k},L7:function(){return y},M1:function(){return d},Mc:function(){return p},OD:function(){return q},P:function(){return w},PI:function(){return h},Pg:function(){return B},Qt:function(){return C},Sn:function(){return f},TH:function(){return i},U3:function(){return G},UK:function(){return j},VG:function(){return s},Xt:function(){return S},Y8:function(){return a},YI:function(){return r},YS:function(){return c},al:function(){return g},bU:function(){return v},dO:function(){return A},g2:function(){return R},j6:function(){return L},jE:function(){return W},lE:function(){return P},pH:function(){return K},pZ:function(){return _},pr:function(){return F},qC:function(){return U},qu:function(){return m},ry:function(){return b},sD:function(){return n},si:function(){return u},tb:function(){return E},vO:function(){return D},vW:function(){return x},xM:function(){return I}});var o=l(9455);const r=e=>o.A.get("/StoreItem/list2",{params:{...e}}),a=e=>o.A.get("/StoreItem/findById",{params:{...e}}),n=()=>o.A.get("/Store/getStoreNames"),u=e=>o.A.post("/StoreItem/add",e),i=e=>o.A.post("/StoreItem/edit",e),d=e=>o.A.post("/StoreItem/delete",e),s=e=>o.A.post("/Store/add",e),c=e=>o.A.get("/StoreItem/GetBuyGoodsAll",{params:{...e}}),p=e=>o.A.put("/StoreItem/editBuyGoodsState2",e),g=e=>o.A.get("/Store/getAllStoreAccount",{params:{...e}}),m=e=>o.A.get("/Store/getStoreById",{params:{...e}}),f=e=>o.A.put("/Store/editStoreById",e),b=e=>o.A.delete("/Store/DelStore",{params:{...e}}),A=e=>o.A.post("/Antique/AddAntique",e),h=e=>o.A.get("/Antique/GetAntiqueAll",{params:{...e}}),v=e=>o.A.post("/Antique/login",e),k=e=>o.A.get("/Antique/GetAntiqueCollect",{params:{...e}}),y=e=>o.A.post("/Antique/AddAntiqueCollect",e),F=e=>o.A.get("/Antique/FindAntiqueById",{params:{...e}}),w=e=>o.A.get("/Antique/GetCollectById",{params:{...e}}),S=e=>o.A.put("/Antique/EditCollectById",e),_=e=>o.A.put("/Antique/DelAntiqueCollect",e),q=e=>o.A.put("/Antique/EditAntiqueById",e),C=e=>o.A.get("/Antique/GetStoreForAntique",{params:{...e}}),I=e=>o.A.put("/Antique/DelAntiqueBindStore",e),V=e=>o.A.put("/Antique/AddAntiqueBindStore",e),x=e=>o.A.get("/Antique/GetMyBindStoreById",{params:{...e}}),G=e=>o.A.delete("/StoreItem/DeleteGoodsPic",{params:{...e}}),B=e=>o.A.delete("/Antique/DelAntique",{params:{...e}}),K=e=>o.A.delete("/Store/DeleteStoreCarouselPic",{params:{...e}}),D=e=>o.A.get("/Community/GetAllCommunity",{params:{...e}}),E=e=>o.A.post("/Community/UpdateCommunityStatus",e),W=e=>o.A.delete("/Community/DeleteCommunity",{params:{...e}}),R=e=>o.A.get("/Finance/GetYearStoreStatics",{params:{...e}}),U=e=>o.A.get("/Finance/GetBillsStatistics",{params:{...e}}),L=e=>o.A.get("/Finance/GetTotalStoreStatics",{params:{...e}}),j=e=>o.A.get("/Finance/GetYearStoreStaticsByYear",{params:{...e}}),M=e=>o.A.get("/StoreItem/buyGoodsAllToExcel",{params:{...e},responseType:"blob"}),P=e=>o.A.get("/StoreItem/buyGoodsToExcelById",{params:{...e},responseType:"blob"})},7412:function(e,t,l){l.r(t),l.d(t,{default:function(){return y}});l(4114);var o=l(6768),r=(l(8992),l(4520),l(3949),l(1454),l(144)),a=l(2568),n=l(9685),u=l(7477),i=l(1219);const d=["src"];var s={__name:"addStore",emits:["LoadData"],setup(e,{expose:t,emit:l}){const s=(0,r.KR)(null),c=(0,r.KR)(!1),p=l;let g=(0,r.KR)({});const m=e=>{null!=e.uid&&(0,a.pH)({id:e.uid}).then((e=>{f.carousel=f.carousel.filter((t=>t.src!=e.data))}))},f=(0,r.Kh)({id:"",name:"",src:"",description:"",account:"",password:"",tel:"",carousel:[]}),b=(0,r.KR)([]),A=(0,r.KR)(""),h=()=>{c.value=!1,f.name="",f.description="",f.id="",f.src="",f.account="",f.password="",f.tel="",f.carousel=[],b.value.splice(0,b.value.length)},v=e=>{f.src=e.data},k=e=>{console.log(e,"file carousel"),f.carousel.push({src:e.data})},y=e=>"image/jpeg"!=e.type&&"image/png"!=e.type?(i.nk.error("Avatar picture must be JPG | PNG format!"),!1):!(e.size/1024/1024>2)||(i.nk.error("Avatar picture size can not exceed 2MB!"),!1),F=()=>{console.log(f),s.value.validate((e=>{if(e)if(null==f.id||""==f.id){if(f.password.length<6)return void i.nk.error("密码不能低于6位");if(f.account.length<6)return void i.nk.error("账号不能低于6位");(0,a.VG)(f).then((e=>{console.log(e),c.value=!1,p("LoadData"),h()})).catch((e=>{console.log(e)}))}else{let e={};if(Object.keys(f).forEach((t=>{f[t]!=g.value[t]&&(e[t]=f[t])})),0==Object.keys(e).length)return c.value=!1,void h();(0,a.Sn)({...e,id:f.id}).then((e=>{console.log(e),c.value=!1,p("LoadData"),h()}))}}))},w=(0,r.Kh)({name:[{required:!0,message:"请输入商铺名",trigger:"blur"}],src:[{required:!0,message:"请上传图片",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],account:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],tel:[{required:!0,message:"请输入手机号码",trigger:"blur",validator:(e,t,l)=>{""==t?l(new Error("请输入手机号码")):/^1[3456789]\d{9}$/.test(t)?l():l(new Error("请输入正确的手机号码"))}}],carousel:[{required:!0,message:"请上传轮播图",trigger:"blur"}]}),S=e=>{Object.keys(f).forEach((t=>{f[t]="carousel"!=t?e[t]:e[t]?.map((e=>({src:e.src,id:e.id})))||[]}))},_=(e,t)=>{c.value=!0,A.value=t,console.log(e,"row"),e?.id?(f.id=e.id,(0,a.qu)({id:e.id}).then((e=>{g.value={...e.data},console.log(g,"data"),w.password[0].required=!1,b.value.splice(0,b.value.length),b.value.push(...e.data.carousel.map((e=>({uid:e.id,url:e.src})))),S(e.data)})).catch((e=>{console.log(e)}))):(w.password[0].required=!0,S({}))};return t({show:_}),(e,t)=>{const l=(0,o.g2)("el-input"),a=(0,o.g2)("el-form-item"),i=(0,o.g2)("el-mention"),p=(0,o.g2)("el-icon"),g=(0,o.g2)("el-upload"),S=(0,o.g2)("el-form"),_=(0,o.g2)("el-button"),q=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(q,{title:A.value,modelValue:c.value,"onUpdate:modelValue":t[6]||(t[6]=e=>c.value=e),onClose:h,"align-center":""},{footer:(0,o.k6)((()=>[(0,o.bF)(_,{onClick:h},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("取 消")]))),_:1}),(0,o.bF)(_,{type:"primary",onClick:F},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("确 定")]))),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(S,{model:f,"label-width":"100px",rules:w,ref_key:"form",ref:s},{default:(0,o.k6)((()=>[(0,o.bF)(a,{label:"商铺名",prop:"name"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{modelValue:f.name,"onUpdate:modelValue":t[0]||(t[0]=e=>f.name=e),placeholder:"请输入店铺名称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(a,{label:"账户",prop:"account"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{modelValue:f.account,"onUpdate:modelValue":t[1]||(t[1]=e=>f.account=e),placeholder:"请输入账户"},null,8,["modelValue"])])),_:1}),(0,o.bF)(a,{label:"密码",prop:"password"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{modelValue:f.password,"onUpdate:modelValue":t[2]||(t[2]=e=>f.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),(0,o.bF)(a,{label:"手机号码",prop:"tel"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{modelValue:f.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>f.tel=e),placeholder:"请输入手机号码"},null,8,["modelValue"])])),_:1}),(0,o.bF)(a,{label:"描述",prop:"description"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{type:"textarea",rows:4,modelValue:f.description,"onUpdate:modelValue":t[4]||(t[4]=e=>f.description=e),placeholder:"请输入店铺描述"},null,8,["modelValue"])])),_:1}),(0,o.bF)(a,{label:"头像",prop:"src"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{class:"avatar-uploader",action:(0,r.R1)(n.p)+"/admin/upload",name:"storeAvatar","auto-upload":"false","show-file-list":!1,"on-success":v,"before-upload":y},{default:(0,o.k6)((()=>[f.src?((0,o.uX)(),(0,o.CE)("img",{key:0,src:f.src,class:"avatar"},null,8,d)):((0,o.uX)(),(0,o.Wv)(p,{key:1,class:"avatar-uploader-icon"},{default:(0,o.k6)((()=>[(0,o.bF)((0,r.R1)(u.FWt))])),_:1}))])),_:1},8,["action"])])),_:1}),(0,o.bF)(a,{label:"轮播图",prop:"carousel"},{default:(0,o.k6)((()=>[(0,o.bF)(g,{"file-list":b.value,"onUpdate:fileList":t[5]||(t[5]=e=>b.value=e),action:(0,r.R1)(n.p)+"/admin/upload",name:"storeAvatar","list-type":"picture-card","on-remove":m,limit:"5","on-success":k},{default:(0,o.k6)((()=>[(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.bF)((0,r.R1)(u.FWt))])),_:1})])),_:1},8,["file-list","action"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}},c=l(1241);const p=(0,c.A)(s,[["__scopeId","data-v-0c27d51e"]]);var g=p,m=l(4588);const f={class:"page"},b={style:{"background-color":"white",padding:"20px","box-sizing":"border-box","text-align":"start"}},A=["src"],h={style:{"margin-top":"20px"}};var v={__name:"StoreManage",setup(e){const t=(0,r.KR)(0),l=(0,r.Kh)({id:"",name:""});console.log(m.A.ls.get("userId"),"pro__");const n=(0,r.Kh)([]),u=()=>{l.id="",l.name="",F()},d=()=>{F(),c()},s=()=>{v.value=1,F()},c=()=>{(0,a.sD)().then((e=>{n.splice(0,n.length,...e.data)})).catch((e=>{console.log(e)}))};c();const p=(0,r.KR)(null),v=(0,r.KR)(1),k=(0,r.Kh)([]),y=()=>{p.value.show({},"新增店铺")},F=()=>{(0,a.al)({page:v.value,pageSize:10,...l}).then((e=>{console.log(e),k.splice(0,k.length),k.push(...e.data.list),t.value=e.data.total,v.value=e.data.pageNum})).catch((e=>{console.log(e)}))};F();const w=e=>{console.log(e),p.value.show(e,"编辑店铺")},S=e=>{console.log(e,"del"),(0,a.ry)({id:e.id}).then((e=>{i.nk.success("删除成功"),F()})).catch((e=>{console.log(e)}))},_=e=>{v.value=e,F()};return(e,r)=>{const a=(0,o.g2)("el-option"),i=(0,o.g2)("el-select"),c=(0,o.g2)("el-form-item"),m=(0,o.g2)("el-button"),F=(0,o.g2)("el-row"),q=(0,o.g2)("el-form"),C=(0,o.g2)("el-table-column"),I=(0,o.g2)("el-popconfirm"),V=(0,o.g2)("el-table"),x=(0,o.g2)("el-pagination");return(0,o.uX)(),(0,o.CE)("div",f,[(0,o.Lk)("div",b,[(0,o.bF)(q,null,{default:(0,o.k6)((()=>[(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(c,{label:"门店名称",prop:"store"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{style:{width:"200px"},placeholder:"请选择门店名称",modelValue:l.id,"onUpdate:modelValue":r[0]||(r[0]=e=>l.id=e),filterable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n,(e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{onClick:u},{default:(0,o.k6)((()=>r[1]||(r[1]=[(0,o.eW)("重置")]))),_:1}),(0,o.bF)(m,{type:"primary",onClick:s},{default:(0,o.k6)((()=>r[2]||(r[2]=[(0,o.eW)("搜索")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Lk)("div",null,[(0,o.bF)(m,{type:"primary",onClick:y},{default:(0,o.k6)((()=>r[3]||(r[3]=[(0,o.eW)("新建店铺")]))),_:1})]),(0,o.bF)(V,{data:k,style:{width:"100%","margin-top":"20px"},border:""},{default:(0,o.k6)((()=>[(0,o.bF)(C,{type:"selection",width:"55"}),(0,o.bF)(C,{prop:"id",label:"id",width:"80","show-overflow-tooltip":"",align:"center"}),(0,o.bF)(C,{prop:"src",label:"门店头像",width:"150","show-overflow-tooltip":"",align:"center"},{default:(0,o.k6)((e=>[(0,o.Lk)("img",{src:e.row.src,alt:"",style:{width:"100px",height:"100px"}},null,8,A)])),_:1}),(0,o.bF)(C,{prop:"name",label:"门店名称",width:"150","show-overflow-tooltip":"",align:"center"}),(0,o.bF)(C,{prop:"description",label:"门店描述","show-overflow-tooltip":"",width:"300",align:"center"}),(0,o.bF)(C,{prop:"role",label:"权限",width:"130",align:"center"}),(0,o.bF)(C,{prop:"account",label:"账户",width:"130",align:"center"}),(0,o.bF)(C,{prop:"password",label:"密码(加密)",width:"200",align:"center","show-overflow-tooltip":""}),(0,o.bF)(C,{prop:"create_date",label:"创建时间",width:"160",align:"center"}),(0,o.bF)(C,{label:"操作",width:"180",fixed:"right",align:"center"},{default:(0,o.k6)((e=>[(0,o.bF)(m,{type:"primary",onClick:t=>w(e.row)},{default:(0,o.k6)((()=>r[4]||(r[4]=[(0,o.eW)("编辑")]))),_:2},1032,["onClick"]),(0,o.bF)(I,{title:"确定要删除该店铺吗?",width:"200",onConfirm:t=>S(e.row)},{reference:(0,o.k6)((()=>[(0,o.bF)(m,{type:"danger"},{default:(0,o.k6)((()=>r[5]||(r[5]=[(0,o.eW)("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),(0,o.Lk)("div",h,[(0,o.bF)(x,{background:"",layout:"total, prev, pager, next","page-size":10,total:t.value,style:{"justify-content":"flex-end","margin-right":"50px"},"current-page":v.value,onCurrentChange:_},null,8,["total","current-page"])])]),(0,o.bF)(g,{onLoadData:d,ref_key:"storeModal",ref:p},null,512)])}}};const k=(0,c.A)(v,[["__scopeId","data-v-53baebf2"]]);var y=k}}]);
//# sourceMappingURL=412.b7f31474.js.map