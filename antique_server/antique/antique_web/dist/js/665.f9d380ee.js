"use strict";(self["webpackChunkoil"]=self["webpackChunkoil"]||[]).push([[665],{2568:function(e,t,l){l.d(t,{Aq:function(){return M},Hq:function(){return V},IC:function(){return v},L7:function(){return k},M1:function(){return d},Mc:function(){return c},OD:function(){return q},P:function(){return F},PI:function(){return y},Pg:function(){return G},Qt:function(){return C},Sn:function(){return f},TH:function(){return i},U3:function(){return K},UK:function(){return X},VG:function(){return s},Xt:function(){return w},Y8:function(){return n},YI:function(){return r},YS:function(){return p},al:function(){return m},bU:function(){return h},dO:function(){return A},g2:function(){return R},j6:function(){return E},jE:function(){return U},lE:function(){return Y},pH:function(){return B},pZ:function(){return S},pr:function(){return _},qC:function(){return L},qu:function(){return g},ry:function(){return b},sD:function(){return a},si:function(){return u},tb:function(){return D},vO:function(){return W},vW:function(){return x},xM:function(){return I}});var o=l(9455);const r=e=>o.A.get("/StoreItem/list2",{params:{...e}}),n=e=>o.A.get("/StoreItem/findById",{params:{...e}}),a=()=>o.A.get("/Store/getStoreNames"),u=e=>o.A.post("/StoreItem/add",e),i=e=>o.A.post("/StoreItem/edit",e),d=e=>o.A.post("/StoreItem/delete",e),s=e=>o.A.post("/Store/add",e),p=e=>o.A.get("/StoreItem/GetBuyGoodsAll",{params:{...e}}),c=e=>o.A.put("/StoreItem/editBuyGoodsState2",e),m=e=>o.A.get("/Store/getAllStoreAccount",{params:{...e}}),g=e=>o.A.get("/Store/getStoreById",{params:{...e}}),f=e=>o.A.put("/Store/editStoreById",e),b=e=>o.A.delete("/Store/DelStore",{params:{...e}}),A=e=>o.A.post("/Antique/AddAntique",e),y=e=>o.A.get("/Antique/GetAntiqueAll",{params:{...e}}),h=e=>o.A.post("/Antique/login",e),v=e=>o.A.get("/Antique/GetAntiqueCollect",{params:{...e}}),k=e=>o.A.post("/Antique/AddAntiqueCollect",e),_=e=>o.A.get("/Antique/FindAntiqueById",{params:{...e}}),F=e=>o.A.get("/Antique/GetCollectById",{params:{...e}}),w=e=>o.A.put("/Antique/EditCollectById",e),S=e=>o.A.put("/Antique/DelAntiqueCollect",e),q=e=>o.A.put("/Antique/EditAntiqueById",e),C=e=>o.A.get("/Antique/GetStoreForAntique",{params:{...e}}),I=e=>o.A.put("/Antique/DelAntiqueBindStore",e),V=e=>o.A.put("/Antique/AddAntiqueBindStore",e),x=e=>o.A.get("/Antique/GetMyBindStoreById",{params:{...e}}),K=e=>o.A.delete("/StoreItem/DeleteGoodsPic",{params:{...e}}),G=e=>o.A.delete("/Antique/DelAntique",{params:{...e}}),B=e=>o.A.delete("/Store/DeleteStoreCarouselPic",{params:{...e}}),W=e=>o.A.get("/Community/GetAllCommunity",{params:{...e}}),D=e=>o.A.post("/Community/UpdateCommunityStatus",e),U=e=>o.A.delete("/Community/DeleteCommunity",{params:{...e}}),R=e=>o.A.get("/Finance/GetYearStoreStatics",{params:{...e}}),L=e=>o.A.get("/Finance/GetBillsStatistics",{params:{...e}}),E=e=>o.A.get("/Finance/GetTotalStoreStatics",{params:{...e}}),X=e=>o.A.get("/Finance/GetYearStoreStaticsByYear",{params:{...e}}),M=e=>o.A.get("/StoreItem/buyGoodsAllToExcel",{params:{...e},responseType:"blob"}),Y=e=>o.A.get("/StoreItem/buyGoodsToExcelById",{params:{...e},responseType:"blob"})},3665:function(e,t,l){l.r(t),l.d(t,{default:function(){return k}});l(4114);var o=l(6768),r=l(4232),n=l(2568),a=l(144),u=(l(1454),l(7477)),i=l(9685),d=l(1219),s=l(4588),p={__name:"StoreItemModal",emits:["LoadData"],setup(e,{expose:t,emit:l}){const r=(0,a.KR)(!1),p=(0,a.KR)([]),c=(0,a.Kh)({store:"",name:"",description:"",store_id:"",money:"",transport_money:"",depository:"",src:[],id:null}),m=JSON.parse(s.A.ls.get("user")),g=(0,a.KR)({role:m.role});c.store_id=m.id;const f=(0,a.Kh)([]),b=l,A=()=>{"超级管理员"==m.role&&(0,n.sD)().then((e=>{f.splice(0,f.length,...e.data)}))};A();const y=()=>{r.value=!1,p.value.splice(0,p.value.length),w({name:"",description:"",money:"",transport_money:"",depository:"",src:[],id:null})},h=e=>{console.log(e,"file"),console.log(p,"fileList"),c.src.push({src:e.data})},v=e=>{console.log(e.uid,"file remove"),null!=e.uid&&(0,n.U3)({id:e.uid}).then((t=>{console.log(t,"res"),c.src.splice(c.src.indexOf(e.url),1)}))},k=(0,a.KR)(null),_=(0,a.Kh)({store_id:[{required:!0,message:"请选择门店名称",trigger:"blur"}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],money:[{required:!0,message:"请输入正确的商品价格",trigger:"blur",type:"number",transform(e){return!!/\d/g.test(e)&&Number(e)}}],transport_money:[{required:!0,message:"请输入正确的运费",trigger:"blur",type:"number",transform(e){return!!/\d/g.test(e)&&Number(e)}}],depository:[{required:!0,message:"请输入正确的库存",trigger:"blur",type:"number",transform(e){return!!/\d/g.test(e)&&Number(e)}}],description:[{required:!0,message:"请输入商品描述",trigger:"blur"}],src:[{required:!0,message:"请上传商品图片",trigger:"blur"}]}),F=(0,a.KR)(""),w=e=>{Object.assign(c,e)},S=async()=>{await k.value.validate(((e,t)=>{if(!e)return console.log(t,"fields"),!1;null==c.id?(0,n.si)(c).then((e=>{console.log(e,"res"),d.nk.success("添加成功"),r.value=!1,y(),b("LoadData")})).catch((e=>{d.nk.error("添加失败")})):(0,n.TH)(c).then((e=>{console.log(e,"res"),d.nk.success("编辑成功"),r.value=!1,y(),b("LoadData")})).catch((e=>{d.nk.error("编辑失败")}))}))},q=(e,t)=>{r.value=!0,F.value=t,e?.id&&(c.id=e.id,(0,n.Y8)({id:e.id}).then((e=>{p.value.splice(0,p.value.length),console.log(e.data,"data"),e.data.src.length>0&&p.value.push(...e.data.src.map((e=>({uid:e.id,url:e.src})))),console.log(p.value,"filelist"),w(e.data)})))};return t({show:q}),(e,t)=>{const l=(0,o.g2)("el-option"),n=(0,o.g2)("el-select"),d=(0,o.g2)("el-form-item"),s=(0,o.g2)("el-input"),m=(0,o.g2)("el-mention"),b=(0,o.g2)("el-icon"),A=(0,o.g2)("el-upload"),w=(0,o.g2)("el-form"),q=(0,o.g2)("el-button"),C=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(C,{title:F.value,center:"",modelValue:r.value,"onUpdate:modelValue":t[7]||(t[7]=e=>r.value=e),width:"700px","before-close":y},{footer:(0,o.k6)((()=>[(0,o.bF)(q,{onClick:y},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("取 消")]))),_:1}),(0,o.bF)(q,{onClick:S,type:"primary"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("确 定")]))),_:1})])),default:(0,o.k6)((()=>[(0,o.bF)(w,{model:c,"label-width":"80px",rules:_,ref_key:"form",ref:k},{default:(0,o.k6)((()=>["超级管理员"==g.value.role?((0,o.uX)(),(0,o.Wv)(d,{key:0,label:"门店",prop:"store"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{modelValue:c.store_id,"onUpdate:modelValue":t[0]||(t[0]=e=>c.store_id=e),placeholder:"请选择门店",filterable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f,(e=>((0,o.uX)(),(0,o.Wv)(l,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,o.Q3)("",!0),(0,o.bF)(d,{label:"商品名称",prop:"name"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{modelValue:c.name,"onUpdate:modelValue":t[1]||(t[1]=e=>c.name=e),placeholder:"请输入商品名称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"商品价格",prop:"money"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{modelValue:c.money,"onUpdate:modelValue":t[2]||(t[2]=e=>c.money=e),placeholder:"请输入商品价格"},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"运费",prop:"transport_money"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{modelValue:c.transport_money,"onUpdate:modelValue":t[3]||(t[3]=e=>c.transport_money=e),placeholder:"请输入运输费用"},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"库存",prop:"depository"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{modelValue:c.depository,"onUpdate:modelValue":t[4]||(t[4]=e=>c.depository=e),placeholder:"请输入商品库存"},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"商品描述",prop:"description"},{default:(0,o.k6)((()=>[(0,o.bF)(m,{style:{"max-width":"250px"},rows:4,modelValue:c.description,"onUpdate:modelValue":t[5]||(t[5]=e=>c.description=e),type:"textarea",placeholder:"请输入商品描述"},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,{label:"商品图片",prop:"src"},{default:(0,o.k6)((()=>[(0,o.bF)(A,{"file-list":p.value,"onUpdate:fileList":t[6]||(t[6]=e=>p.value=e),action:(0,a.R1)(i.p)+"/admin/upload",name:"storeAvatar","list-type":"picture-card","on-remove":v,limit:"5","on-success":h},{default:(0,o.k6)((()=>[(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.bF)((0,a.R1)(u.FWt))])),_:1})])),_:1},8,["file-list","action"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}},c=l(1241);const m=(0,c.A)(p,[["__scopeId","data-v-734f2eda"]]);var g=m;const f={class:"page"},b={style:{"background-color":"white",padding:"20px","box-sizing":"border-box","text-align":"start"}},A=["src"],y={style:{"margin-top":"20px"}};var h={__name:"GoodsManage",setup(e){const t=(0,a.KR)(0),l=(0,a.Kh)({store_id:"",name:""}),u=JSON.parse(s.A.ls.get("user")),i=(0,a.KR)({role:u.role}),p=(0,a.Kh)([]),c=()=>{l.store_id="",l.name="",w()},m=()=>{k.value=1,w()},h=()=>{"超级管理员"==i.value.role&&(console.log("load",i.value.role),(0,n.sD)().then((e=>{p.splice(0,p.length,...e.data)})).catch((e=>{console.log(e)})))};h();const v=(0,a.KR)(null),k=((0,a.KR)(null),(0,a.KR)(1)),_=(0,a.Kh)([]),F=()=>{v.value.show(null,"新增商品")},w=()=>{(0,n.YI)({page:k.value,pageSize:10,...l}).then((e=>{console.log(e),_.splice(0,_.length),_.push(...e.data.list),t.value=e.data.total,k.value=e.data.pageNum})).catch((e=>{console.log(e)}))};w();const S=e=>{v.value.show(e,"编辑商品"),console.log(e)},q=e=>{console.log(e,"del"),(0,n.M1)({id:e.id}).then((e=>{d.nk.success("删除成功"),w()})).catch((e=>{console.log(e)}))},C=e=>{k.value=e,w()};return(e,n)=>{const a=(0,o.g2)("el-option"),u=(0,o.g2)("el-select"),d=(0,o.g2)("el-form-item"),s=(0,o.g2)("el-input"),h=(0,o.g2)("el-button"),I=(0,o.g2)("el-row"),V=(0,o.g2)("el-form"),x=(0,o.g2)("el-table-column"),K=(0,o.g2)("el-popconfirm"),G=(0,o.g2)("el-table"),B=(0,o.g2)("el-pagination");return(0,o.uX)(),(0,o.CE)("div",f,[(0,o.Lk)("div",b,[(0,o.bF)(V,null,{default:(0,o.k6)((()=>[(0,o.bF)(I,null,{default:(0,o.k6)((()=>["超级管理员"==i.value.role?((0,o.uX)(),(0,o.Wv)(d,{key:0,label:"门店名称",prop:"store"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{style:{width:"200px"},placeholder:"请选择门店名称",modelValue:l.store_id,"onUpdate:modelValue":n[0]||(n[0]=e=>l.store_id=e),filterable:""},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p,(e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):(0,o.Q3)("",!0),(0,o.bF)(d,{label:"商品名称",prop:"name"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{style:{width:"200px"},placeholder:"请输入商品名称",modelValue:l.name,"onUpdate:modelValue":n[1]||(n[1]=e=>l.name=e)},null,8,["modelValue"])])),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(h,{onClick:c},{default:(0,o.k6)((()=>n[2]||(n[2]=[(0,o.eW)("重置")]))),_:1}),(0,o.bF)(h,{type:"primary",onClick:m},{default:(0,o.k6)((()=>n[3]||(n[3]=[(0,o.eW)("搜索")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Lk)("div",null,[(0,o.bF)(h,{type:"primary",onClick:F},{default:(0,o.k6)((()=>n[4]||(n[4]=[(0,o.eW)("新增商品")]))),_:1})]),(0,o.bF)(G,{data:_,style:{width:"100%","margin-top":"20px"},border:""},{default:(0,o.k6)((()=>[(0,o.bF)(x,{type:"selection",width:"55"}),(0,o.bF)(x,{prop:"id",label:"id",width:"80","show-overflow-tooltip":"",align:"center"}),(0,o.bF)(x,{prop:"store",label:"门店名称",width:"150","show-overflow-tooltip":"",align:"center"}),(0,o.bF)(x,{prop:"name",label:"商品名称","show-overflow-tooltip":"",width:"150",align:"center"}),(0,o.bF)(x,{prop:"url",label:"商品图片",width:"170","show-overflow-tooltip":"",align:"center"},{default:(0,o.k6)((e=>[(0,o.Lk)("img",{src:e.row.url,alt:"",style:{width:"100px",height:"100px"}},null,8,A)])),_:1}),(0,o.bF)(x,{prop:"description",label:"商品描述","show-overflow-tooltip":"",width:"240",align:"center"}),(0,o.bF)(x,{prop:"money",label:"商品价格",width:"120",align:"center"},{default:(0,o.k6)((e=>[(0,o.eW)((0,r.v_)(e.row.money.toFixed(2)),1)])),_:1}),(0,o.bF)(x,{prop:"transport_money",label:"运费",width:"120",align:"center"},{default:(0,o.k6)((e=>[(0,o.eW)((0,r.v_)(e.row.transport_money.toFixed(2)),1)])),_:1}),(0,o.bF)(x,{prop:"sale",label:"销量",width:"100",align:"center"}),(0,o.bF)(x,{prop:"depository",label:"库存",width:"100",align:"center"}),(0,o.bF)(x,{label:"操作",width:"180",fixed:"right",align:"center"},{default:(0,o.k6)((e=>[(0,o.bF)(h,{type:"primary",onClick:t=>S(e.row)},{default:(0,o.k6)((()=>n[5]||(n[5]=[(0,o.eW)("编辑")]))),_:2},1032,["onClick"]),(0,o.bF)(K,{title:"确定要删除该商品吗?",width:"200",onConfirm:t=>q(e.row)},{reference:(0,o.k6)((()=>[(0,o.bF)(h,{type:"danger"},{default:(0,o.k6)((()=>n[6]||(n[6]=[(0,o.eW)("删除")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),(0,o.Lk)("div",y,[(0,o.bF)(B,{background:"",layout:"total, prev, pager, next","page-size":10,total:t.value,style:{"justify-content":"flex-end","margin-right":"50px"},"current-page":k.value,onCurrentChange:C},null,8,["total","current-page"])])]),(0,o.bF)(g,{onLoadData:w,ref_key:"storeItemModal",ref:v},null,512)])}}};const v=(0,c.A)(h,[["__scopeId","data-v-72e7cb94"]]);var k=v}}]);
//# sourceMappingURL=665.f9d380ee.js.map